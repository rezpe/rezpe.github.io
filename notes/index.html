<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Notes</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .note-card {
            transition: all 0.3s ease;
        }
        .note-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s ease;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
        .recording {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .note-image {
            max-width: 150px;
            max-height: 150px;
            width: auto;
            height: auto;
            border-radius: 8px;
            object-fit: cover;
        }
        .audio-player {
            width: 100%;
            height: 40px;
        }
        .note-type-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.1);
            color: rgba(0, 0, 0, 0.6);
        }
        .color-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .color-circle:hover {
            transform: scale(1.1);
        }
        .color-circle.selected {
            border-color: #374151;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-sticky-note text-yellow-500 text-2xl"></i>
                        <h1 class="text-xl font-semibold text-gray-900">My Notes</h1>
                    </div>
                    <div class="text-sm text-gray-500">
                        {{ notes.length }} {{ notes.length === 1 ? 'note' : 'notes' }}
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Add Note Form -->
            <div class="mb-8">
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 max-w-2xl mx-auto">
                    <!-- Note Type Selector -->
                    <div class="flex space-x-2 mb-4">
                        <button
                            @click="setNoteType('text')"
                            :class="newNote.type === 'text' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'"
                            class="px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                        >
                            <i class="fas fa-font mr-2"></i>Text
                        </button>
                        <button
                            @click="setNoteType('voice')"
                            :class="newNote.type === 'voice' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'"
                            class="px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                        >
                            <i class="fas fa-microphone mr-2"></i>Voice
                        </button>
                        <button
                            @click="setNoteType('image')"
                            :class="newNote.type === 'image' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'"
                            class="px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                        >
                            <i class="fas fa-image mr-2"></i>Image
                        </button>
                    </div>

                    <div class="space-y-4">
                        <!-- Title (for all note types) -->
                        <input
                            v-model="newNote.title"
                            @keyup.enter="addNote"
                            type="text"
                            placeholder="Title"
                            class="w-full text-lg font-medium border-none outline-none placeholder-gray-400"
                        >

                        <!-- Text Note -->
                        <div v-if="newNote.type === 'text'">
                            <textarea
                                v-model="newNote.content"
                                @keyup.ctrl.enter="addNote"
                                placeholder="Take a note..."
                                rows="3"
                                class="w-full border-none outline-none placeholder-gray-400 resize-none"
                            ></textarea>
                        </div>

                        <!-- Voice Note -->
                        <div v-else-if="newNote.type === 'voice'" class="space-y-4">
                            <div class="flex items-center space-x-4">
                                <button
                                    @click="toggleRecording"
                                    :class="isRecording ? 'bg-red-500 recording' : 'bg-green-500'"
                                    class="px-4 py-2 text-white rounded-lg hover:opacity-80 transition-all"
                                >
                                    <i :class="isRecording ? 'fas fa-stop' : 'fas fa-microphone'" class="mr-2"></i>
                                    {{ isRecording ? 'Stop Recording' : 'Start Recording' }}
                                </button>
                                <span v-if="isRecording" class="text-sm text-gray-600">
                                    Recording... {{ recordingTime }}s
                                </span>
                            </div>
                            
                            <div v-if="newNote.audioBlob" class="bg-gray-50 p-4 rounded-lg">
                                <audio :src="newNote.audioUrl" controls class="audio-player"></audio>
                                <button
                                    @click="clearRecording"
                                    class="mt-2 text-sm text-red-600 hover:text-red-800"
                                >
                                    <i class="fas fa-trash mr-1"></i>Clear Recording
                                </button>
                            </div>
                        </div>

                        <!-- Image Note -->
                        <div v-else-if="newNote.type === 'image'" class="space-y-4">
                            <div class="flex flex-wrap gap-2">
                                <button
                                    @click="triggerImageUpload"
                                    class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                                >
                                    <i class="fas fa-upload mr-2"></i>Upload Image
                                </button>
                                <button
                                    @click="captureImage"
                                    class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"
                                >
                                    <i class="fas fa-camera mr-2"></i>Take Photo
                                </button>
                            </div>
                            
                            <!-- Paste Area -->
                            <div 
                                @paste="handlePaste"
                                @dragover.prevent
                                @drop.prevent="handleDrop"
                                class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-blue-400 transition-colors"
                                tabindex="0"
                            >
                                <i class="fas fa-clipboard text-gray-400 text-2xl mb-2"></i>
                                <p class="text-gray-500 text-sm">
                                    Paste an image here (Ctrl+V) or drag & drop
                                </p>
                            </div>
                            
                            <input
                                ref="imageInput"
                                type="file"
                                accept="image/*"
                                @change="handleImageUpload"
                                class="hidden"
                            >
                            
                            <div v-if="newNote.imageUrl" class="bg-gray-50 p-4 rounded-lg">
                                <img :src="newNote.imageUrl" alt="Note image" class="note-image mb-2">
                                <button
                                    @click="clearImage"
                                    class="text-sm text-red-600 hover:text-red-800"
                                >
                                    <i class="fas fa-trash mr-1"></i>Remove Image
                                </button>
                            </div>

                            <!-- Camera capture modal -->
                            <div v-if="showCamera" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                <div class="bg-white p-6 rounded-lg max-w-md w-full mx-4">
                                    <div class="flex justify-between items-center mb-4">
                                        <h3 class="text-lg font-semibold">Take Photo</h3>
                                        <button @click="closeCamera" class="text-gray-500 hover:text-gray-700">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                    <video ref="video" autoplay class="w-full rounded-lg mb-4"></video>
                                    <canvas ref="canvas" class="hidden"></canvas>
                                    <div class="flex space-x-2">
                                        <button
                                            @click="takePicture"
                                            class="flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                                        >
                                            <i class="fas fa-camera mr-2"></i>Capture
                                        </button>
                                        <button
                                            @click="closeCamera"
                                            class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Color Palette -->
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <span class="text-sm text-gray-600 mr-2">Color:</span>
                                <div class="flex space-x-2">
                                    <div
                                        v-for="color in availableColors"
                                        :key="color.value"
                                        @click="newNote.color = color.value"
                                        :class="[
                                            'color-circle',
                                            color.class,
                                            { 'selected': newNote.color === color.value }
                                        ]"
                                        :title="color.name"
                                    ></div>
                                </div>
                            </div>
                            <button
                                @click="addNote"
                                :disabled="!canAddNote"
                                class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
                            >
                                <i class="fas fa-plus mr-2"></i>Add Note
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search Bar -->
            <div class="mb-6 max-w-md mx-auto">
                <div class="relative">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    <input
                        v-model="searchQuery"
                        type="text"
                        placeholder="Search notes..."
                        class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                </div>
            </div>

            <!-- Notes Grid -->
            <div v-if="filteredNotes.length === 0 && searchQuery" class="text-center py-12">
                <i class="fas fa-search text-gray-300 text-4xl mb-4"></i>
                <p class="text-gray-500">No notes found matching "{{ searchQuery }}"</p>
            </div>

            <div v-else-if="notes.length === 0" class="text-center py-12">
                <i class="fas fa-sticky-note text-gray-300 text-6xl mb-4"></i>
                <p class="text-gray-500 text-lg">No notes yet. Create your first note above!</p>
            </div>

            <div v-else class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                <transition-group name="fade">
                    <div
                        v-for="note in filteredNotes"
                        :key="note.id"
                        :class="getNoteColorClass(note.color)"
                        class="note-card rounded-lg border border-gray-200 p-4 cursor-pointer relative group"
                        @click="editNote(note)"
                    >
                        <!-- Note Type Badge -->
                        <div class="note-type-badge">
                            <i :class="getNoteTypeIcon(note.type)"></i>
                            {{ note.type }}
                        </div>

                        <!-- Note Content -->
                        <div v-if="editingNote?.id !== note.id">
                            <h3 v-if="note.title" class="font-semibold text-gray-900 mb-2 line-clamp-2 pr-16">{{ note.title }}</h3>
                            
                            <!-- Text Content -->
                            <p v-if="note.type === 'text'" class="text-gray-700 whitespace-pre-wrap line-clamp-6">{{ note.content }}</p>
                            
                            <!-- Voice Content -->
                            <div v-else-if="note.type === 'voice'" class="space-y-2">
                                <audio v-if="note.audioUrl" :src="note.audioUrl" controls class="audio-player"></audio>
                                <p v-if="note.content" class="text-gray-700 text-sm">{{ note.content }}</p>
                            </div>
                            
                            <!-- Image Content -->
                            <div v-else-if="note.type === 'image'" class="space-y-2">
                                <img 
                                    v-if="note.imageUrl" 
                                    :src="note.imageUrl" 
                                    alt="Note image" 
                                    class="note-image cursor-pointer hover:opacity-80 transition-opacity" 
                                    @click.stop="openImageModal(note.imageUrl)"
                                >
                                <p v-if="note.content" class="text-gray-700 text-sm">{{ note.content }}</p>
                            </div>

                            <div class="mt-3 flex items-center justify-between text-xs text-gray-500">
                                <span>{{ formatDate(note.updatedAt) }}</span>
                                <button
                                    @click.stop="deleteNote(note.id)"
                                    class="opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-100 rounded"
                                >
                                    <i class="fas fa-trash text-red-500"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Edit Mode -->
                        <div v-else @click.stop class="space-y-3">
                            <input
                                v-model="editingNote.title"
                                type="text"
                                placeholder="Title"
                                class="w-full font-semibold bg-transparent border-none outline-none mb-2 placeholder-gray-400"
                            >
                            
                            <!-- Edit Text -->
                            <textarea
                                v-if="editingNote.type === 'text'"
                                v-model="editingNote.content"
                                rows="4"
                                class="w-full bg-transparent border-none outline-none resize-none placeholder-gray-400"
                                @keyup.esc="cancelEdit"
                                @keyup.ctrl.enter="saveEdit"
                            ></textarea>
                            
                            <!-- Edit Voice -->
                            <div v-else-if="editingNote.type === 'voice'" class="space-y-2">
                                <audio v-if="editingNote.audioUrl" :src="editingNote.audioUrl" controls class="audio-player"></audio>
                                <textarea
                                    v-model="editingNote.content"
                                    rows="2"
                                    placeholder="Add description..."
                                    class="w-full bg-transparent border-none outline-none resize-none placeholder-gray-400 text-sm"
                                ></textarea>
                            </div>
                            
                            <!-- Edit Image -->
                            <div v-else-if="editingNote.type === 'image'" class="space-y-2">
                                <img v-if="editingNote.imageUrl" :src="editingNote.imageUrl" alt="Note image" class="note-image">
                                <textarea
                                    v-model="editingNote.content"
                                    rows="2"
                                    placeholder="Add description..."
                                    class="w-full bg-transparent border-none outline-none resize-none placeholder-gray-400 text-sm"
                                ></textarea>
                            </div>

                            <div class="space-y-3">
                                <!-- Color Palette for Edit -->
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs text-gray-600">Color:</span>
                                    <div class="flex space-x-1">
                                        <div
                                            v-for="color in availableColors"
                                            :key="color.value"
                                            @click="editingNote.color = color.value"
                                            :class="[
                                                'color-circle',
                                                color.class,
                                                { 'selected': editingNote.color === color.value }
                                            ]"
                                            :title="color.name"
                                            style="width: 24px; height: 24px;"
                                        ></div>
                                    </div>
                                </div>
                                <!-- Action Buttons -->
                                <div class="flex justify-end space-x-2">
                                    <button
                                        @click="cancelEdit"
                                        class="px-2 py-1 text-xs text-gray-600 hover:bg-gray-100 rounded"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        @click="saveEdit"
                                        class="px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        Save
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </transition-group>
            </div>
        </main>

        <!-- Image Modal -->
        <div v-if="showImageModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50" @click="closeImageModal">
            <div class="relative max-w-screen-lg max-h-screen-lg p-4">
                <button 
                    @click="closeImageModal" 
                    class="absolute top-2 right-2 text-white bg-black bg-opacity-50 rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-75 transition-all z-10"
                >
                    <i class="fas fa-times"></i>
                </button>
                <img 
                    :src="modalImageUrl" 
                    alt="Full size image" 
                    class="max-w-full max-h-full object-contain rounded-lg"
                    @click.stop
                >
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                const notes = ref([]);
                const newNote = ref({
                    type: 'text',
                    title: '',
                    content: '',
                    color: 'white',
                    audioBlob: null,
                    audioUrl: null,
                    imageUrl: null
                });
                const editingNote = ref(null);
                const searchQuery = ref('');
                
                // Voice recording
                const isRecording = ref(false);
                const recordingTime = ref(0);
                const mediaRecorder = ref(null);
                const recordingTimer = ref(null);
                
                // Camera
                const showCamera = ref(false);
                const stream = ref(null);
                const imageInput = ref(null);
                const video = ref(null);
                const canvas = ref(null);

                // Image modal
                const showImageModal = ref(false);
                const modalImageUrl = ref('');

                // Available colors for notes
                const availableColors = [
                    { value: 'white', name: 'Default', class: 'bg-white border-gray-300' },
                    { value: 'yellow', name: 'Yellow', class: 'bg-yellow-200' },
                    { value: 'green', name: 'Green', class: 'bg-green-200' },
                    { value: 'blue', name: 'Blue', class: 'bg-blue-200' },
                    { value: 'pink', name: 'Pink', class: 'bg-pink-200' },
                    { value: 'purple', name: 'Purple', class: 'bg-purple-200' }
                ];

                // Load notes from localStorage
                const loadNotes = () => {
                    const saved = localStorage.getItem('keepCloneNotesEnhanced');
                    if (saved) {
                        notes.value = JSON.parse(saved);
                    }
                };

                // Save notes to localStorage
                const saveNotes = () => {
                    localStorage.setItem('keepCloneNotesEnhanced', JSON.stringify(notes.value));
                };

                // Set note type
                const setNoteType = (type) => {
                    newNote.value.type = type;
                    // Clear type-specific data when switching
                    if (type !== 'voice') {
                        clearRecording();
                    }
                    if (type !== 'image') {
                        clearImage();
                    }
                };

                // Voice recording functions
                const toggleRecording = async () => {
                    if (isRecording.value) {
                        stopRecording();
                    } else {
                        await startRecording();
                    }
                };

                const startRecording = async () => {
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        mediaRecorder.value = new MediaRecorder(stream);
                        const chunks = [];

                        mediaRecorder.value.ondataavailable = (event) => {
                            chunks.push(event.data);
                        };

                        mediaRecorder.value.onstop = () => {
                            const blob = new Blob(chunks, { type: 'audio/wav' });
                            newNote.value.audioBlob = blob;
                            newNote.value.audioUrl = URL.createObjectURL(blob);
                            stream.getTracks().forEach(track => track.stop());
                        };

                        mediaRecorder.value.start();
                        isRecording.value = true;
                        recordingTime.value = 0;
                        
                        recordingTimer.value = setInterval(() => {
                            recordingTime.value++;
                        }, 1000);
                    } catch (error) {
                        alert('Could not access microphone. Please check permissions.');
                    }
                };

                const stopRecording = () => {
                    if (mediaRecorder.value && isRecording.value) {
                        mediaRecorder.value.stop();
                        isRecording.value = false;
                        clearInterval(recordingTimer.value);
                    }
                };

                const clearRecording = () => {
                    if (newNote.value.audioUrl) {
                        URL.revokeObjectURL(newNote.value.audioUrl);
                    }
                    newNote.value.audioBlob = null;
                    newNote.value.audioUrl = null;
                    recordingTime.value = 0;
                };

                // Image functions
                const triggerImageUpload = () => {
                    imageInput.value.click();
                };

                const handleImageUpload = (event) => {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            newNote.value.imageUrl = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                };

                const captureImage = async () => {
                    try {
                        stream.value = await navigator.mediaDevices.getUserMedia({ video: true });
                        showCamera.value = true;
                        
                        await nextTick();
                        video.value.srcObject = stream.value;
                    } catch (error) {
                        alert('Could not access camera. Please check permissions.');
                    }
                };

                const takePicture = () => {
                    const context = canvas.value.getContext('2d');
                    canvas.value.width = video.value.videoWidth;
                    canvas.value.height = video.value.videoHeight;
                    context.drawImage(video.value, 0, 0);
                    
                    newNote.value.imageUrl = canvas.value.toDataURL('image/png');
                    closeCamera();
                };

                const closeCamera = () => {
                    if (stream.value) {
                        stream.value.getTracks().forEach(track => track.stop());
                        stream.value = null;
                    }
                    showCamera.value = false;
                };

                const clearImage = () => {
                    newNote.value.imageUrl = null;
                    if (imageInput.value) {
                        imageInput.value.value = '';
                    }
                };

                // Handle paste events for images
                const handlePaste = (event) => {
                    const items = event.clipboardData?.items;
                    if (!items) return;

                    for (let i = 0; i < items.length; i++) {
                        const item = items[i];
                        if (item.type.indexOf('image') !== -1) {
                            const file = item.getAsFile();
                            if (file) {
                                const reader = new FileReader();
                                reader.onload = (e) => {
                                    newNote.value.imageUrl = e.target.result;
                                };
                                reader.readAsDataURL(file);
                            }
                            break;
                        }
                    }
                };

                // Handle drag and drop for images
                const handleDrop = (event) => {
                    const files = event.dataTransfer?.files;
                    if (!files || files.length === 0) return;

                    const file = files[0];
                    if (file.type.indexOf('image') !== -1) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            newNote.value.imageUrl = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                };

                // Image modal functions
                const openImageModal = (imageUrl) => {
                    modalImageUrl.value = imageUrl;
                    showImageModal.value = true;
                };

                const closeImageModal = () => {
                    showImageModal.value = false;
                    modalImageUrl.value = '';
                };

                // Check if note can be added
                const canAddNote = computed(() => {
                    switch (newNote.value.type) {
                        case 'text':
                            return newNote.value.content.trim();
                        case 'voice':
                            return newNote.value.audioBlob;
                        case 'image':
                            return newNote.value.imageUrl;
                        default:
                            return false;
                    }
                });

                // Add new note
                const addNote = () => {
                    if (!canAddNote.value) return;

                    const note = {
                        id: Date.now(),
                        type: newNote.value.type,
                        title: newNote.value.title.trim(),
                        content: newNote.value.content.trim(),
                        color: newNote.value.color,
                        createdAt: new Date(),
                        updatedAt: new Date()
                    };

                    // Add type-specific data
                    if (newNote.value.type === 'voice' && newNote.value.audioUrl) {
                        note.audioUrl = newNote.value.audioUrl;
                    }
                    if (newNote.value.type === 'image' && newNote.value.imageUrl) {
                        note.imageUrl = newNote.value.imageUrl;
                    }

                    notes.value.unshift(note);
                    saveNotes();

                    // Reset form
                    newNote.value = {
                        type: 'text',
                        title: '',
                        content: '',
                        color: 'white',
                        audioBlob: null,
                        audioUrl: null,
                        imageUrl: null
                    };
                };

                // Delete note
                const deleteNote = (id) => {
                    if (confirm('Are you sure you want to delete this note?')) {
                        notes.value = notes.value.filter(note => note.id !== id);
                        saveNotes();
                    }
                };

                // Edit note
                const editNote = (note) => {
                    editingNote.value = { ...note };
                };

                // Save edit
                const saveEdit = () => {
                    const index = notes.value.findIndex(note => note.id === editingNote.value.id);
                    if (index !== -1) {
                        notes.value[index] = {
                            ...editingNote.value,
                            updatedAt: new Date()
                        };
                        saveNotes();
                    }
                    editingNote.value = null;
                };

                // Cancel edit
                const cancelEdit = () => {
                    editingNote.value = null;
                };

                // Get note color class
                const getNoteColorClass = (color) => {
                    const colorClasses = {
                        white: 'bg-white',
                        yellow: 'bg-yellow-100',
                        green: 'bg-green-100',
                        blue: 'bg-blue-100',
                        pink: 'bg-pink-100',
                        purple: 'bg-purple-100'
                    };
                    return colorClasses[color] || 'bg-white';
                };

                // Get note type icon
                const getNoteTypeIcon = (type) => {
                    const icons = {
                        text: 'fas fa-font',
                        voice: 'fas fa-microphone',
                        image: 'fas fa-image'
                    };
                    return icons[type] || 'fas fa-sticky-note';
                };

                // Format date
                const formatDate = (date) => {
                    const now = new Date();
                    const noteDate = new Date(date);
                    const diffTime = Math.abs(now - noteDate);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                    if (diffDays === 1) {
                        return 'Today';
                    } else if (diffDays === 2) {
                        return 'Yesterday';
                    } else if (diffDays <= 7) {
                        return `${diffDays - 1} days ago`;
                    } else {
                        return noteDate.toLocaleDateString();
                    }
                };

                // Filtered notes based on search
                const filteredNotes = computed(() => {
                    if (!searchQuery.value.trim()) {
                        return notes.value;
                    }
                    const query = searchQuery.value.toLowerCase();
                    return notes.value.filter(note =>
                        note.title.toLowerCase().includes(query) ||
                        note.content.toLowerCase().includes(query)
                    );
                });

                // Load notes on mount
                onMounted(() => {
                    loadNotes();
                });

                return {
                    notes,
                    newNote,
                    editingNote,
                    searchQuery,
                    filteredNotes,
                    isRecording,
                    recordingTime,
                    showCamera,
                    showImageModal,
                    modalImageUrl,
                    imageInput,
                    video,
                    canvas,
                    availableColors,
                    canAddNote,
                    setNoteType,
                    addNote,
                    deleteNote,
                    editNote,
                    saveEdit,
                    cancelEdit,
                    toggleRecording,
                    clearRecording,
                    triggerImageUpload,
                    handleImageUpload,
                    captureImage,
                    takePicture,
                    closeCamera,
                    clearImage,
                    handlePaste,
                    handleDrop,
                    openImageModal,
                    closeImageModal,
                    getNoteColorClass,
                    getNoteTypeIcon,
                    formatDate
                };
            }
        }).mount('#app');
    </script>
</body>
</html> 